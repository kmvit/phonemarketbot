# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
- –ù–æ–≤–æ–µ –ø–æ–ª–µ `parent_category` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `products` –∏ `preorder_products`
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π

### 2. –ê–ª–≥–æ—Ä–∏—Ç–º –ø–∞—Ä—Å–∏–Ω–≥–∞

#### –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `extract_categories_from_excel_v2()`
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É Excel —Ñ–∞–π–ª–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:

**–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, META, APPLE, Nintendo):
- –°—Ç—Ä–æ–∫–∏ –ë–ï–ó —Ü–µ–Ω—ã
- –û–∫—Ä—É–∂–µ–Ω—ã –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –î–û –∏ –ü–û–°–õ–ï
- –û–±—ã—á–Ω–æ —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è –±—Ä–µ–Ω–¥–æ–≤ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
- –ü–æ—Å–ª–µ –Ω–∏—Ö –º–æ–≥—É—Ç –∏–¥—Ç–∏ –ª–∏–±–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –ª–∏–±–æ —Å—Ä–∞–∑—É —Ç–æ–≤–∞—Ä—ã

**–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Apple iPhone 17 256GB"):
- –°—Ç—Ä–æ–∫–∏ –ë–ï–ó —Ü–µ–Ω—ã
- –ò–¥—É—Ç –ø–æ—Å–ª–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ü–æ—Å–ª–µ –Ω–∏—Ö —Å—Ä–∞–∑—É –∏–¥—É—Ç —Ç–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–∞–º–∏
- –û–±–æ–∑–Ω–∞—á–∞—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏

**–¢–æ–≤–∞—Ä—ã**:
- –°—Ç—Ä–æ–∫–∏ –° —Ü–µ–Ω–æ–π
- –°–æ–¥–µ—Ä–∂–∞—Ç –¥–µ—Ç–∞–ª–∏: –ø–∞–º—è—Ç—å, —Ü–≤–µ—Ç, —Ç–∏–ø SIM, —Å—Ç—Ä–∞–Ω—É

#### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞:
```
[–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞]
META                          <- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
[–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞]
Meta Quest 3S 256GB üáØüáµ 29300  <- –¢–æ–≤–∞—Ä (–Ω–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π)
Meta Quest 3 512GB üá™üá∫  41100  <- –¢–æ–≤–∞—Ä

[–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞]
Apple                         <- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
[–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞]
Apple iPhone 17 256GB         <- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è
Apple iPhone 17 256GB Black   <- –¢–æ–≤–∞—Ä
Apple iPhone 17 256GB Blue    <- –¢–æ–≤–∞—Ä
[–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞]
Apple iPhone 17 512GB         <- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è
Apple iPhone 17 512GB White   <- –¢–æ–≤–∞—Ä
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `load_price_from_excel_simple_format()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é `extract_categories_from_excel_v2()`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é –≤ –ë–î
- –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è `parent_category` –∏ `category`

#### `get_dynamic_parent_to_subcategories()`
- –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–µ `parent_category` –∏–∑ –ë–î
- Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ parent_category
- –ù–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π, –µ—Å–ª–∏ –æ–Ω–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç

### 4. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –±–æ—Ç–µ

**–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ë–ï–ó –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π** (Meta Quest, Nintendo):
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ —Å–ø–∏—Å–∫–µ
2. –°—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤

**–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –° –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏** (Apple):
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "Apple" –≤ —Å–ø–∏—Å–∫–µ
2. –í—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Apple iPhone 17 256GB")
3. –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —ç—Ç–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∞–π—Å–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É:
```bash
cd /Users/home/PycharmProjects/phonemarketbot
./venv/bin/python -c "
from admin.price_loader import load_price_from_excel_auto
from db.models import init_db

init_db()
count = load_price_from_excel_auto('01–í—Å–µ —Ç–æ–≤–∞—Ä—ã (2).xlsx', source='simple')
print(f'–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {count}')
"
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
```bash
./venv/bin/python -c "
from db.crud import get_dynamic_parent_to_subcategories

mapping = get_dynamic_parent_to_subcategories('simple')
for parent, subcats in mapping.items():
    print(f'{parent}: {len(subcats)} –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π')
"
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ (—Å —ç–º–æ–¥–∑–∏ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏) –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `load_price_from_excel_auto()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã (–º–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫—É `parent_category`)
- ‚úÖ Fallback –ª–æ–≥–∏–∫–∞ –≤ `get_dynamic_parent_to_subcategories()` –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
